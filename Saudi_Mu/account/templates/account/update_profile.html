{% extends 'main/base.html' %}
{% load static %}
{% block title %}Update {{ request.user.username }}{% endblock %}
{% block content %}

    <link rel="stylesheet" href="{% static 'css/account.css' %}">



<div class="signup-box">

    <div class="side-image"></div>

    <div class="form-container">

        <h2>Update Your Profile</h2>
        <p class="desc">Fill in the information below to update your profile details.</p>

        <form action="{% url 'account:update_user_profile' %}" method="POST" enctype="multipart/form-data">
            {% csrf_token %}

            <div class="input-group">
                <label>Email</label>
                <input type="email" name="email" value="{{ request.user.email }}" required>
            </div>

            <div class="input-group">
                <label>First Name</label>
                <input type="text" name="first_name" value="{{ request.user.first_name }}" required>
            </div>

            <div class="input-group">
                <label>Last Name</label>
                <input type="text" name="last_name" value="{{ request.user.last_name }}" required>
            </div>

            <div class="input-group">
                <label>About Me</label>
                <textarea name="about">{{ request.user.profile.about }}</textarea>
            </div>

            
   <div class="mb-3">
                <label class="form-label">Profile Picture</label>
                <div class="mb-2">
                    {% if request.user.profile.avatar %}
                        <img id="avatarPreview" src="{{ request.user.profile.avatar.url }}" 
                             class="rounded-3" 
                             style="width:120px; height:120px; object-fit:cover; border:3px solid #4A0E2E;">
                    {% else %}
                        <img id="avatarPreview" src="" 
                             class="rounded-3 d-none" 
                             style="width:120px; height:120px; object-fit:cover; border:3px solid #4A0E2E;">
                    {% endif %}
                </div>
                <input class="form-control" type="file" name="avatar" accept="image/*" id="avatarInput">
            </div>

            <button class="submit-btn" type="submit">Update Profile</button>
        </form>
    </div>
</div>

<!-- ضع السكربت هنا بعد الفورم -->
<script>
    const avatarInput = document.getElementById('avatarInput');
    const avatarPreview = document.getElementById('avatarPreview');

    avatarInput.addEventListener('change', function(){
        const file = this.files[0];
        if (file){
            const reader = new FileReader();
            reader.onload = function(e){
                avatarPreview.src = e.target.result;
                avatarPreview.classList.remove('d-none');
            }
            reader.readAsDataURL(file);
        }
    });
</script>



            <button class="submit-btn" type="submit">Update Profile</button>
        </form>

    </div>
</div>


{% endblock %}
