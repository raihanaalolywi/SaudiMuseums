{% extends 'main/base.html' %}
{% load static %}

{% block title %}{{ authority.name }} - Profile{% endblock %}

{% block content %}
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
<link rel="stylesheet" href="{% static 'css/profile.css' %}">

<div class="container my-5 profile-page">

    <!-- Authority Card -->
    <div class="card card-custom p-4 mb-4">
        <div class="row g-4 align-items-center">

            <!-- Logo Left -->
            <div class="col-md-3 text-center">

                <!-- صورة الهيئة حسب ما يرفعه المستخدم -->
                <img src="{% if authority.image %}{{ authority.image.url }}{% else %}{% static 'images/default_authority.png' %}{% endif %}"
                     alt="Authority Logo"
                     class="profile-img mb-3">

                <!-- يظهر للمالك فقط -->
{% if request.user == authority.owner %}
    <a href="{% url 'account:update_authority_profile' authority_id=authority.id %}" 
       class="btn btn-primary btn-sm w-100">
       Update Profile
    </a>
{% endif %}

            </div>

            <!-- Authority Details -->
            <div class="col-md-9">
                <h4>{{ authority.name }}</h4>

                {% if authority.description %}
                    <div class="about-me mt-2">
                        <h5>About</h5>
                        <p>{{ authority.description }}</p>
                    </div>
                {% else %}
                    <p class="text-muted">No description available.</p>
                {% endif %}

                {% if authority.website_link %}
                    <p class="mt-2">
                        Website: 
                        <a href="{{ authority.website_link }}" target="_blank">
                            {{ authority.website_link }}
                        </a>
                    </p>
                {% endif %}

                {% if authority.location %}
                    <p class="mt-1">
                        Location: {{ authority.location }}
                    </p>
                {% endif %}
            </div>

        </div>
    </div>

    <!-- Museums Managed by This Authority -->
    <div class="row g-3 mb-4">
        <div class="col-12">
            <div class="stats-card p-3">
                <h5>Managed Museums ({{ authority.museum_set.count }})</h5>

                {% if authority.museum_set.exists %}
                <ul class="list-group list-group-flush">
                    {% for museum in authority.museum_set.all %}
                        <li class="list-group-item d-flex justify-content-between">
                            <span>{{ museum.name }}</span>

                            <!-- زر تفاصيل المتحف -->
<a href="{% url 'details' museum.id %}" class="btn btn-outline-primary btn-sm">
    View Details
</a>
                            
                        </li>
                    {% endfor %}
                </ul>

                {% else %}
                    <p class="text-muted mt-3">No museums added yet.</p>
                {% endif %}
            </div>
        </div>
    </div>

</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
{% endblock %}
